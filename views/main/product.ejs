<% layout('layout') -%>


<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.5&appId=578927152259054";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<div class="container">
  <div class="row">

    <div class="col-md-4">
      <img class="product-image" src="<%= product.image %>">
    </div>

    <div class="col-md-8">
      <h1><%= product.name %></h1>
      <h3> Price :<%= product.price %></h3>
      <h3> Downloads : <%= product.downloads %></h3>

      <form method="post">


        <div class="form-group">
          <input type="hidden" name="product_id" id="quantity" value="<%= product._id %>"></input>
        </div>
        <%
        if(user){
         var count=0;
        for(i=0;i<user.history.length;i++){
        if (JSON.stringify(product._id) == JSON.stringify(user.history[i].item)){
        count=1;
        break;
        }}
       %>
        <% if (count==1)  { %>
          <a href='/profile' class="btn btn-warning btn-lg">book is downloaded!</a>
        <% } else{ %>
        <button type="submit" class="btn btn-primary btn-lg">Add to Cart</button>
          <% }} else { %>
        <a href='/signup' class="btn btn-warning btn-lg">please sign up!</a>
          <% } %>
      </form>

    </div>
    </div>
    <div class="row">
    <br/>
      <div class="col-md-4">
      <div class="fb-like" data-href="http://localhost:3000/product/<%= product._id %>" data-width="400" data-layout="button_count" data-action="like" data-show-faces="true" data-share="true"></div>
      </div>
      <div class="col-md-8">
        <div class="fb-comments"
        data-href="http://localhost:3000/product/<%= product._id%>" data-width="800" data-numposts="6"></div>
      </div>


  </div>
</div>
